<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Using MicroK8s (for Mac user)
Get and install Multipass https://microk8s.io/docs/install-alternatives#macos
Spin up a local machine and exec into it
multipass launch --name microk8s --mem 4G --disk 40G multipass shell microk8s Next wie need to install microk8s and set an alias to make our life easier
sudo snap install microk8s --classic --channel=1.17/stable vim ~/.bash_aliases alias k=&#39;sudo microk8s.kubectl&#39; #save &amp; close it . ~/.bash_aliases k cluster-info Now we have a K8s running, next we need to spin up some basic services"><meta property="og:title" content="Development Setup" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://cloud-native-eam.github.io/alexandria/docs/devenv/" />

<title>Development Setup | Alexandria Documentation</title>
<link rel="icon" href="/alexandria/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/alexandria/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css" integrity="sha256-Y&#43;uI2qVFNlQF7NuyEDMoajJcYKNs&#43;m0i0h58O8koaUE=">


<script defer src="/alexandria/en.search.min.8b2c6699f6a2007ff337cefadf76ae9c27e086dd95a73927d46f86fba74a11cb.js" integrity="sha256-iyxmmfaiAH/zN87633aunCfght2Vpzkn1G&#43;G&#43;6dKEcs="></script>

<link rel="alternate" type="application/rss+xml" href="https://cloud-native-eam.github.io/alexandria/docs/devenv/index.xml" title="Alexandria Documentation" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/alexandria"><span>Alexandria Documentation</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/alexandria/docs/architecture/" class="">Architecture</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/alexandria/docs/architecture/alexandria/" class="">Alexandria</a>
  


    




  
  <ul>
    
  </ul>
  



  </li>


      
    
      
        

  <li>
    

  
  <a href="/alexandria/docs/architecture/pharos/" class="">Pharos</a>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/alexandria/docs/architecture/pharos/aws/" class="">AWS Pharos</a>
  

</li>
      
    
      
        <li>

  
  <a href="/alexandria/docs/architecture/pharos/k8s/" class="">Kubernetes Pharos</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        <li>

  
  <a href="/alexandria/docs/architecture/datamodel/" class="">Datamodel</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/alexandria/docs/devenv/" class="active">Development Setup</a>
  


    




  
  <ul>
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/alexandria/docs/writing-docs/" class="">Documenting</a>
  


    




  
  <ul>
    
  </ul>
  



  </li>


      
    
  </ul>
  



  












  
<ul>
  
  <li>
    <a href="https://github.com/cloud-native-eam/alexandria" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/alexandria/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Development Setup</strong>

  <label for="toc-control">
    <img src="/alexandria/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#using-microk8s">Using MicroK8s</a>
      <ul>
        <li><a href="#accessing-service-on-k8s">Accessing Service on K8s</a></li>
        <li><a href="#configure-you-local-kubeconfig">Configure you local kubeconfig</a></li>
        <li><a href="#about-multipass">About Multipass</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="using-microk8s">Using MicroK8s</h1>
<p>(for Mac user)</p>
<p>Get and install Multipass <a href="https://microk8s.io/docs/install-alternatives#macos">https://microk8s.io/docs/install-alternatives#macos</a></p>
<p>Spin up a local machine and exec into it</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass launch --name microk8s --mem 4G --disk 40G
multipass shell microk8s
</code></pre></div><p>Next wie need to install microk8s and set an alias to make our life easier</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo snap install microk8s --classic --channel<span style="color:#f92672">=</span>1.17/stable
vim ~/.bash_aliases
alias k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sudo microk8s.kubectl&#39;</span> <span style="color:#75715e">#save &amp; close it</span>
. ~/.bash_aliases
k cluster-info
</code></pre></div><p>Now we have a K8s running, next we need to spin up some basic services</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo microk8s.enable dns dashboard storage helm3 rbac
k get all -A
</code></pre></div><p>Next we need to be sure that we can do access the K8s in the VM</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo iptables -P FORWARD ACCEPT
</code></pre></div><h2 id="accessing-service-on-k8s">Accessing Service on K8s</h2>
<p>To access we need actually two things 1. the IP of the VW and 2. the API for the service</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass list 
<span style="color:#75715e">#take the IP from your host/client</span>
<span style="color:#75715e">#and the api from K8s</span>
k cluster-info
<span style="color:#75715e">#https://127.0.0.1:16443/api/v1/namespaces/kube-system/services/monitoring-grafana/proxy</span>
</code></pre></div><p>In your Webbrowser you now need to replace the local IP with the IP of the VM, then you will get asked for username and password. This you get in the VM by running</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo microk8s.config
<span style="color:#75715e">#in the end of the config you find the admin and PW</span>
</code></pre></div><p>Now you should be able to log into the Dashboard!
This way you can reach all exposed workload.</p>
<h2 id="configure-you-local-kubeconfig">Configure you local kubeconfig</h2>
<p>At the moment you run K8s within the VM and you can reach the API, but you can&rsquo;t use kubectl from a local machine.
Therefore you need to update your kubeconfig which you can mostly found in your root under .kube/config
In a first step you need from within the VM the Kubeconfig</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo microk8s.kubectl config view --raw
</code></pre></div><p>Then you open the kubeconfig and add cluster, context and user. Don&rsquo;t forget to replace the local IP with the VM IP. In the End your kubeconfig should looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">clusters</span>:
- <span style="color:#66d9ef">cluster</span>:
    <span style="color:#66d9ef">certificate-authority-data</span>: SUPERSECRET_CA_AUTH
    <span style="color:#66d9ef">server</span>: https://<span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">16443</span> 
  <span style="color:#66d9ef">name</span>: microk8s-cluster
<span style="color:#66d9ef">contexts</span>:
- <span style="color:#66d9ef">context</span>:
    <span style="color:#66d9ef">cluster</span>: docker-desktop
    <span style="color:#66d9ef">user</span>: docker-desktop
  <span style="color:#66d9ef">name</span>: docker-desktop
- <span style="color:#66d9ef">context</span>:
    <span style="color:#66d9ef">cluster</span>: microk8s-cluster
    <span style="color:#66d9ef">user</span>: admin
  <span style="color:#66d9ef">name</span>: microk8s
<span style="color:#66d9ef">current-context</span>: microk8s
<span style="color:#66d9ef">kind</span>: Config
<span style="color:#66d9ef">preferences</span>: {}
<span style="color:#66d9ef">users</span>:
- <span style="color:#66d9ef">name</span>: admin
  <span style="color:#66d9ef">user</span>:
    <span style="color:#66d9ef">password</span>: SUPERSECRETPASSWORT
    <span style="color:#66d9ef">username</span>: admin
</code></pre></div><p>Save the config and run on you host/client</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">kubectl get all -A
</code></pre></div><p>If you see all the resources within the K8s from the VM you are done!</p>
<h2 id="about-multipass">About Multipass</h2>
<p>Start VM</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass start microk8s
</code></pre></div><p>Stop VM</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass stop microk8s
</code></pre></div><p>Exec/Shell into VM</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass shell microk8s
</code></pre></div><p>Delete &amp; Clean up VMs</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">multipass delete microk8s
multipass purge
</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#using-microk8s">Using MicroK8s</a>
      <ul>
        <li><a href="#accessing-service-on-k8s">Accessing Service on K8s</a></li>
        <li><a href="#configure-you-local-kubeconfig">Configure you local kubeconfig</a></li>
        <li><a href="#about-multipass">About Multipass</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












